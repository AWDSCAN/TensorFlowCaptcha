# è®­ç»ƒç“¶é¢ˆåˆ†æä¸çªç ´ç­–ç•¥

**æ—¥æœŸ**: 2026-01-31  
**å½“å‰çŠ¶æ€**: å®Œæ•´åŒ¹é…ç‡79.5%å³°å€¼åæ³¢åŠ¨ï¼Œåœ¨150500æ­¥ç»ˆæ­¢  
**ç›®æ ‡**: çªç ´80%ï¼Œå‘85%è¿ˆè¿›

---

## ğŸ“Š è®­ç»ƒè¡¨ç°åˆ†æ

### å³°å€¼è¡¨ç°
- **æœ€ä½³å®Œæ•´åŒ¹é…**: 79.50% (Step 145500)
- **æœ€ä½³éªŒè¯æŸå¤±**: 0.0068 (Step 149500)
- **ç»ˆæ­¢æ—¶å‡†ç¡®ç‡**: 77.20%
- **è®­ç»ƒæ­¥æ•°**: 150500 (è¾¾åˆ°ä¸Šé™)

### åæœŸæ³¢åŠ¨ç‰¹å¾
```
Step 145500: 79.50% â­ å³°å€¼
Step 146000: 76.40% 
Step 146500: 77.10%
Step 147000: 77.40%
Step 147500: 75.80%
Step 148000: 76.40%
Step 148500: 75.60%
Step 149000: 78.20%
Step 149500: 79.00%
Step 150000: 77.00%
Step 150500: 77.60% â†’ ç»ˆæ­¢
```

**æ³¢åŠ¨å¹…åº¦**: 75.6% - 79.5% (çº¦4%æ³¢åŠ¨)

---

## ğŸ” ç“¶é¢ˆåˆ†æ

### 1. æ¨¡å‹å·²æ¥è¿‘æ”¶æ•›
**è¯æ®**:
- å­¦ä¹ ç‡: 0.000591-0.000603ï¼ˆå·²å¾ˆå°ï¼‰
- éªŒè¯æŸå¤±: 0.0068-0.0081ï¼ˆç¨³å®šåœ¨ä½ä½ï¼‰
- äºŒè¿›åˆ¶å‡†ç¡®ç‡: 99.85-99.88%ï¼ˆå·²å¾ˆé«˜ï¼‰

**ç»“è®º**: æ¨¡å‹åœ¨å½“å‰æ¶æ„å’Œæ•°æ®ä¸‹æ¥è¿‘æ€§èƒ½ä¸Šé™

### 2. å…¸å‹é”™è¯¯æ¨¡å¼

ä»ç¤ºä¾‹é¢„æµ‹åˆ†æï¼š
```
âŒ PCBEa4Fb â†’ PCBEa Fb   (ç©ºæ ¼è¯¯è¯†åˆ«)
âŒ 4mjCR2vO â†’ 4micR2yO   (jâ†’iæ··æ·†, vâ†’yæ··æ·†)
âŒ 3AZQ4JyQ â†’ 34ZQ4JyQ   (Aâ†’4æ··æ·†)
âŒ prtyu619 â†’ prty 619   (uæ¶ˆå¤±ï¼Œç©ºæ ¼æ’å…¥)
```

**ä¸»è¦é—®é¢˜**:
1. **ç©ºæ ¼å¤„ç†**: ç©ºæ ¼ä½ç½®åˆ¤æ–­ä¸å‡†ç¡®
2. **å­—ç¬¦æ··æ·†**: ç›¸ä¼¼å­—ç¬¦éš¾ä»¥åŒºåˆ†ï¼ˆl/I, 0/O, j/i, A/4, v/yç­‰ï¼‰
3. **å­—ç¬¦ä¸¢å¤±**: ä¸ªåˆ«å­—ç¬¦è¢«è·³è¿‡æˆ–åˆå¹¶

---

## âœ… å·²å®æ–½çš„ä¼˜åŒ–è°ƒæ•´

### 1. å¢åŠ è®­ç»ƒæ­¥æ•° â±ï¸
```python
max_steps: 150000 â†’ 200000  # +50000æ­¥
```

**ç†ç”±**: ç»™æ¨¡å‹æ›´å¤šæ—¶é—´æ‰¾åˆ°æ›´ä¼˜è§£

### 2. è°ƒæ•´ç›®æ ‡å‡†ç¡®ç‡ ğŸ¯
```python
end_acc: 0.85 â†’ 0.82  # æ›´ç°å®çš„è¿‘æœŸç›®æ ‡
```

**ç†ç”±**: ä»79.5%åˆ°82%æ›´å¯è¾¾ï¼Œé¿å…è¿‡æ—©ç»ˆæ­¢

### 3. å¢åŠ éªŒè¯é¢‘ç‡ ğŸ“Š
```python
validation_steps: 500 â†’ 300  # æ›´é¢‘ç¹è§‚å¯Ÿ
```

**ç†ç”±**: åœ¨æ³¢åŠ¨åŒºé—´æ›´å¯†é›†åœ°ç›‘æ§å’Œä¿å­˜æœ€ä½³çŠ¶æ€

---

## ğŸš€ è¿›ä¸€æ­¥ä¼˜åŒ–ç­–ç•¥

### ç­–ç•¥A: ä¼˜åŒ–æŸå¤±å‡½æ•°æƒé‡ âš–ï¸

**å½“å‰é…ç½®**: 
- Focal Loss gamma=2.0
- pos_weight=3.5

**ä¼˜åŒ–æ–¹æ¡ˆ**:
```python
# è¿›ä¸€æ­¥å¢åŠ å›°éš¾æ ·æœ¬æƒé‡
focal_gamma: 2.0 â†’ 2.5
pos_weight: 3.5 â†’ 4.0
```

**é¢„æœŸæ•ˆæœ**: æ›´å…³æ³¨æ˜“æ··æ·†å­—ç¬¦ï¼Œå‡å°‘è¯†åˆ«é”™è¯¯

---

### ç­–ç•¥B: é›†æˆå­¦ä¹  ğŸ²

**åŸç†**: è®­ç»ƒå¤šä¸ªæ¨¡å‹ï¼ŒæŠ•ç¥¨å†³ç­–

**å®æ–½æ–¹æ¡ˆ**:
```python
# 1. ä¿å­˜3ä¸ªä¸åŒé˜¶æ®µçš„æ¨¡å‹
model_145k = load('checkpoint_step_145000.keras')  # 79.5%å³°å€¼é™„è¿‘
model_148k = load('checkpoint_step_148000.keras')
model_150k = load('checkpoint_step_150000.keras')

# 2. é›†æˆé¢„æµ‹
predictions = [
    model_145k.predict(image),
    model_148k.predict(image),
    model_150k.predict(image)
]
final_pred = voting(predictions)  # æŠ•ç¥¨æˆ–å¹³å‡
```

**é¢„æœŸæ•ˆæœ**: +1-2%å‡†ç¡®ç‡æå‡

---

### ç­–ç•¥C: å¢å¼ºæ•°æ®è´¨é‡ ğŸ“¸

**é—®é¢˜**: å½“å‰éªŒè¯ç å¯èƒ½ä¸å¤Ÿå¤šæ ·åŒ–

**æ–¹æ¡ˆ1 - å¢åŠ è®­ç»ƒæ•°æ®**:
```bash
cd /data/coding/captcha
python generate_captcha.py --count 50000  # å¢åŠ åˆ°50000å¼ 
```

**æ–¹æ¡ˆ2 - é’ˆå¯¹æ€§ç”Ÿæˆå›°éš¾æ ·æœ¬**:
```python
# ç”Ÿæˆæ›´å¤šæ˜“æ··æ·†å­—ç¬¦ç»„åˆ
difficult_chars = ['l', 'I', '1', 'O', '0', 'j', 'i', 'A', '4', 'v', 'y']
generate_captcha_with_chars(difficult_chars, count=10000)
```

**é¢„æœŸæ•ˆæœ**: +2-3%å‡†ç¡®ç‡æå‡

---

### ç­–ç•¥D: ä¼˜åŒ–ç½‘ç»œæ¶æ„ ğŸ—ï¸

**æ–¹æ¡ˆ1 - æ·»åŠ æ³¨æ„åŠ›æœºåˆ¶**:
```python
# åœ¨FCå±‚å‰æ·»åŠ Self-Attention
x = layers.MultiHeadAttention(
    num_heads=8,
    key_dim=128
)(x, x)
```

**æ–¹æ¡ˆ2 - å¢åŠ ç½‘ç»œæ·±åº¦**:
```python
# å½“å‰ï¼š5å±‚å·ç§¯ + FC 2048
# ä¼˜åŒ–ï¼š6å±‚å·ç§¯ + FC 3072
CONV_FILTERS = [32, 64, 128, 128, 256, 256]
FC_UNITS = 3072
```

**é¢„æœŸæ•ˆæœ**: +2-4%å‡†ç¡®ç‡æå‡

---

### ç­–ç•¥E: Label Smoothing ğŸ¯

**é—®é¢˜**: å½“å‰ä½¿ç”¨ç¡¬æ ‡ç­¾ï¼ˆ0æˆ–1ï¼‰ï¼Œå¯èƒ½å¯¼è‡´è¿‡æ‹Ÿåˆ

**æ–¹æ¡ˆ**:
```python
# åœ¨compile_modelä¸­æ·»åŠ 
def label_smoothing(y_true, epsilon=0.1):
    """
    å°†ç¡¬æ ‡ç­¾å¹³æ»‘åŒ–
    1 â†’ 0.9, 0 â†’ 0.1
    """
    return y_true * (1 - epsilon) + epsilon / 2
```

**é¢„æœŸæ•ˆæœ**: +0.5-1%å‡†ç¡®ç‡æå‡

---

## ğŸ“ˆ ç»¼åˆä¼˜åŒ–è·¯çº¿å›¾

### Phase 1: ç«‹å³å®æ–½ï¼ˆå·²å®Œæˆï¼‰âœ…
- [x] å¢åŠ max_stepsåˆ°200000
- [x] è°ƒæ•´end_accåˆ°0.82
- [x] å¢åŠ éªŒè¯é¢‘ç‡åˆ°300æ­¥

**é¢„æœŸ**: ç¨³å®šè¾¾åˆ°80-82%

---

### Phase 2: å¦‚æœPhase 1è¾¾åˆ°82%

#### æ–¹æ¡ˆAï¼ˆç®€å•ï¼‰- é›†æˆå­¦ä¹ 
```bash
# ä½¿ç”¨å·²æœ‰çš„3ä¸ªcheckpoint
python ensemble_predict.py --models \
  checkpoint_step_145000.keras \
  checkpoint_step_148000.keras \
  checkpoint_step_150000.keras
```

**å·¥ä½œé‡**: 1å°æ—¶  
**é¢„æœŸ**: 82% â†’ 83-84%

#### æ–¹æ¡ˆBï¼ˆä¸­ç­‰ï¼‰- å¢åŠ è®­ç»ƒæ•°æ®
```bash
# ç”Ÿæˆ50000å¼ éªŒè¯ç 
python generate_captcha.py --count 50000

# é‡æ–°è®­ç»ƒ
python train_v4.py
```

**å·¥ä½œé‡**: 4-6å°æ—¶ï¼ˆç”Ÿæˆ+è®­ç»ƒï¼‰  
**é¢„æœŸ**: 82% â†’ 84-85%

---

### Phase 3: å¦‚æœPhase 2ä»æœªè¾¾åˆ°85%

#### æ–¹æ¡ˆCï¼ˆå¤æ‚ï¼‰- æ¶æ„ä¼˜åŒ–
```python
# ä¿®æ”¹ extras/model_enhanced.py
# 1. æ·»åŠ æ³¨æ„åŠ›æœºåˆ¶
# 2. å¢åŠ ç½‘ç»œæ·±åº¦
# 3. ä½¿ç”¨Transformer Encoder
```

**å·¥ä½œé‡**: 1-2å¤©ï¼ˆä»£ç +è®­ç»ƒ+è°ƒä¼˜ï¼‰  
**é¢„æœŸ**: 84% â†’ 86-88%

---

## ğŸ¯ å½“å‰å»ºè®®

### ç«‹å³æ‰§è¡Œï¼ˆPhase 1ï¼‰

```bash
cd /data/coding/caocrvfy
git pull origin main
python train_v4.py  # ä½¿ç”¨æ–°é…ç½®ï¼š200000æ­¥ï¼Œ82%ç›®æ ‡
```

**å…³é”®ç›‘æ§ç‚¹**:
1. Step 160000å·¦å³è§‚å¯Ÿæ˜¯å¦çªç ´80%
2. Step 180000è§‚å¯Ÿæ˜¯å¦ç¨³å®šåœ¨81-82%
3. ä¿å­˜æ‰€æœ‰>80%çš„checkpoint

---

### å¦‚æœPhase 1æˆåŠŸï¼ˆè¾¾åˆ°82%ï¼‰

**ä¸‹ä¸€æ­¥**: é›†æˆå­¦ä¹ ï¼ˆæœ€å¿«çš„æå‡æ–¹å¼ï¼‰

åˆ›å»º `ensemble_predict.py`:
```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
é›†æˆé¢„æµ‹ - ä½¿ç”¨å¤šä¸ªæ¨¡å‹æŠ•ç¥¨
"""

import numpy as np
from tensorflow import keras

def ensemble_predict(models, images):
    """
    é›†æˆé¢„æµ‹ï¼šå¤šæ¨¡å‹æŠ•ç¥¨
    """
    all_preds = []
    
    for model in models:
        pred = model.predict(images, verbose=0)
        all_preds.append(pred)
    
    # å¹³å‡æ¦‚ç‡
    ensemble_pred = np.mean(all_preds, axis=0)
    return ensemble_pred

# åŠ è½½æ¨¡å‹
models = [
    keras.models.load_model('models/checkpoint_step_145000.keras'),
    keras.models.load_model('models/checkpoint_step_148000.keras'),
    keras.models.load_model('models/checkpoint_step_150000.keras')
]

# é›†æˆé¢„æµ‹
predictions = ensemble_predict(models, val_images)
```

**é¢„æœŸå·¥ä½œé‡**: 1å°æ—¶  
**é¢„æœŸæå‡**: +1-2%

---

### å¦‚æœPhase 1å¤±è´¥ï¼ˆæœªè¾¾åˆ°82%ï¼‰

**åŸå› å¯èƒ½**:
1. æ¨¡å‹æ¶æ„é™åˆ¶ï¼ˆéœ€è¦æ›´å¤æ‚çš„ç½‘ç»œï¼‰
2. æ•°æ®è´¨é‡ä¸è¶³ï¼ˆéœ€è¦æ›´å¤šæ›´å¥½çš„è®­ç»ƒæ•°æ®ï¼‰
3. è¶…å‚æ•°æœªä¼˜åŒ–ï¼ˆéœ€è¦æ›´ç³»ç»Ÿçš„è°ƒä¼˜ï¼‰

**ä¸‹ä¸€æ­¥**: æ‰§è¡ŒPhase 3çš„æ¶æ„ä¼˜åŒ–

---

## ğŸ“Š é¢„æœŸæ•ˆæœå¯¹æ¯”

| é˜¶æ®µ | ç­–ç•¥ | å·¥ä½œé‡ | é¢„æœŸå‡†ç¡®ç‡ | æ—¶é—´ |
|------|------|--------|-----------|------|
| **å½“å‰** | - | - | **79.5%** | - |
| **Phase 1** | å¢åŠ æ­¥æ•°+è°ƒæ•´å‚æ•° | 0.5å°æ—¶ | **80-82%** | +30å°æ—¶è®­ç»ƒ |
| **Phase 2A** | é›†æˆå­¦ä¹  | 1å°æ—¶ | **83-84%** | å³æ—¶ |
| **Phase 2B** | å¢åŠ æ•°æ® | 6å°æ—¶ | **84-85%** | +40å°æ—¶è®­ç»ƒ |
| **Phase 3** | æ¶æ„ä¼˜åŒ– | 2å¤© | **86-88%** | +60å°æ—¶è®­ç»ƒ |

---

## ğŸ”§ ä¿®æ”¹æ¸…å•

### train_v4.py
```python
# Line 118-120
max_steps=200000           # 150000 â†’ 200000
validation_steps=300       # 500 â†’ 300  
end_acc=0.82              # 0.85 â†’ 0.82
```

---

## ğŸ“ ç›‘æ§å»ºè®®

### è®­ç»ƒæœŸé—´
```bash
# å®æ—¶æŸ¥çœ‹å‡†ç¡®ç‡è¶‹åŠ¿
tail -f logs/*.log | grep "å®Œæ•´åŒ¹é…"

# æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡
watch -n 3600 'tail -20 logs/*.log | grep "æœ€ä½³å®Œæ•´åŒ¹é…"'
```

### å…³é”®æ­¥æ•°
- **Step 155000**: è§‚å¯Ÿæ˜¯å¦çªç ´80%
- **Step 170000**: è§‚å¯Ÿæ˜¯å¦ç¨³å®šåœ¨81%
- **Step 190000**: è§‚å¯Ÿæ˜¯å¦è¾¾åˆ°82%

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### çŸ­æœŸç›®æ ‡ï¼ˆPhase 1ï¼‰
- âœ… ç¨³å®šè¾¾åˆ°80%ä»¥ä¸Š
- âœ… å³°å€¼è¾¾åˆ°82%
- âœ… æ³¢åŠ¨å¹…åº¦<2%

### ä¸­æœŸç›®æ ‡ï¼ˆPhase 2ï¼‰
- âœ… ç¨³å®šè¾¾åˆ°83%ä»¥ä¸Š
- âœ… å³°å€¼è¾¾åˆ°85%

### é•¿æœŸç›®æ ‡ï¼ˆPhase 3ï¼‰
- âœ… ç¨³å®šè¾¾åˆ°85%ä»¥ä¸Š
- âœ… å³°å€¼è¾¾åˆ°87-88%

---

**å½“å‰çŠ¶æ€**: âœ… Phase 1é…ç½®å·²ä¼˜åŒ–ï¼Œå‡†å¤‡é‡æ–°è®­ç»ƒ  
**é¢„è®¡æ—¶é—´**: 30-35å°æ—¶è®­ç»ƒ  
**ä¸‹ä¸€æ£€æŸ¥ç‚¹**: Step 160000
