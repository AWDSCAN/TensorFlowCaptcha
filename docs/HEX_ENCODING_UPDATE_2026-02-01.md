# 16è¿›åˆ¶ç¼–ç æ›¿ä»£Base64 - æ›´æ–°è¯´æ˜

ğŸ“… **æ›´æ–°æ—¶é—´**: 2026-02-01  
ğŸ¯ **æ›´æ–°ç›®çš„**: ä½¿ç”¨16è¿›åˆ¶ç¼–ç æ›¿ä»£base64ï¼Œå½»åº•è§£å†³ç‰¹æ®Šå­—ç¬¦é—®é¢˜

---

## é—®é¢˜èƒŒæ™¯

åŸbase64ç¼–ç å­˜åœ¨çš„é—®é¢˜ï¼š
```
é”™è¯¯: [Errno 2] No such file or directory: '/data/coding/captcha/img/MTkrOD0/_27_xxx.png'
                                                                         â†‘
                                                            æ–œæ è¢«è¯¯è®¤ä¸ºç›®å½•åˆ†éš”ç¬¦
```

**æ ¹æœ¬åŸå› **: base64ç¼–ç åŒ…å«ç‰¹æ®Šå­—ç¬¦ `/` å’Œ `=`ï¼Œå¯èƒ½åœ¨æŸäº›æ–‡ä»¶ç³»ç»Ÿä¸­è¢«è¯¯è§£æã€‚

---

## è§£å†³æ–¹æ¡ˆ

### ä½¿ç”¨16è¿›åˆ¶ç¼–ç 

**æ–‡ä»¶åæ ¼å¼å˜æ›´**:
```
æ—§æ ¼å¼: MTkrMz0/_22_abc123def456.png  (base64ç¼–ç ï¼ŒåŒ…å«/)
æ–°æ ¼å¼: 31392b333d3f_22_abc123def456.png  (16è¿›åˆ¶ç¼–ç ï¼Œåªæœ‰0-9a-f)
```

### 16è¿›åˆ¶ç¼–ç ç¤ºä¾‹

| åŸæ–‡ | 16è¿›åˆ¶ç¼–ç  | æ–‡ä»¶åç¤ºä¾‹ |
|------|-----------|-----------|
| 2\*8=? | 322a383d3f | 322a383d3f_16_abc123.png |
| 19+3=? | 31392b333d3f | 31392b333d3f_22_def456.png |
| 5\*7=? | 352a373d3f | 352a373d3f_35_xyz789.png |

---

## æŠ€æœ¯ä¼˜åŠ¿

âœ… **æ— ç‰¹æ®Šå­—ç¬¦**: åªåŒ…å« 0-9a-fï¼Œå®Œå…¨é¿å…æ–‡ä»¶è·¯å¾„é—®é¢˜  
âœ… **æ— éœ€å¡«å……**: ä¸åƒbase64éœ€è¦ `=` å¡«å……ï¼Œç¼–è§£ç æ›´ç®€å•  
âœ… **è·¨å¹³å°**: åœ¨Windows/Linux/Macä¸Šéƒ½æ²¡æœ‰å…¼å®¹æ€§é—®é¢˜  
âœ… **æ˜“è°ƒè¯•**: 16è¿›åˆ¶æ›´ç›´è§‚ï¼Œä¾¿äºæ‰‹å·¥éªŒè¯

---

## ä»£ç å˜æ›´

### 1. ç”Ÿæˆå™¨ (captcha/generate_captcha.py)

```python
import binascii  # æ–°å¢

def generate_filename(self, text, answer=None):
    if self.captcha_type == 'math' and answer is not None:
        # ä½¿ç”¨16è¿›åˆ¶ç¼–ç ï¼ˆæ–°ï¼‰
        text_hex = binascii.hexlify(text.encode('utf-8')).decode('utf-8')
        file_hash = self.generate_hash(text + str(answer))[:16]
        return f"{text_hex}_{answer}_{file_hash}.png"
```

### 2. è§£æå™¨ (caocrvfy/core/utils.py)

```python
import binascii  # æ–°å¢

def parse_filename(filename):
    # ä¼˜å…ˆå°è¯•16è¿›åˆ¶è§£ç ï¼ˆæ–°æ ¼å¼ï¼‰
    try:
        decoded_text = binascii.unhexlify(encoded_text.encode('utf-8')).decode('utf-8')
        return decoded_text
    except Exception:
        pass  # å¤±è´¥åˆ™å°è¯•base64ï¼ˆæ—§æ ¼å¼å…¼å®¹ï¼‰
```

---

## å‘åå…¼å®¹

ä»£ç ä¿ç•™äº†å¯¹æ—§base64æ ¼å¼çš„æ”¯æŒï¼š

```python
# è§£æä¼˜å…ˆçº§
1. å°è¯•16è¿›åˆ¶è§£ç  (æ–°æ ¼å¼)
2. å°è¯•URL-safe base64è§£ç  (æ—§æ ¼å¼)
3. å°è¯•æ ‡å‡†base64è§£ç  (æœ€æ—§æ ¼å¼)
4. ä½¿ç”¨æ™®é€šæ ¼å¼è§£æ (éæ•°å­¦é¢˜)
```

**ç°æœ‰æ—§æ•°æ®å¯ä»¥æ­£å¸¸è¯»å–**ï¼Œæ— éœ€è¿ç§»ã€‚

---

## æµ‹è¯•éªŒè¯

### ç¼–è§£ç æµ‹è¯•
```bash
python test_base64_encoding.py
```

è¾“å‡º:
```
åŸæ–‡: 19+3=?
  16è¿›åˆ¶ç¼–ç : 31392b333d3f
  è§£ç è¿˜åŸ: 19+3=?
  æ˜¯å¦ä¸€è‡´: âœ“
```

### æ ‡ç­¾è§£ææµ‹è¯•
```bash
python test_labels.py
```

è¾“å‡º:
```
âœ“ [æ–°æ ¼å¼(16è¿›åˆ¶)] 31392b333d3f_22_def456.png
  è®­ç»ƒæ ‡ç­¾: 19+3=?

âœ“ [æ—§æ ¼å¼(base64)] MTkrMz0/_22_abc.png
  è®­ç»ƒæ ‡ç­¾: 19+3=?  â† å‘åå…¼å®¹
```

### å®é™…ç”Ÿæˆæµ‹è¯•
```python
from generate_captcha import CaptchaGenerator
gen = CaptchaGenerator(captcha_type='math')
img, text, answer, filename = gen.generate_captcha(save_path='img')

# è¾“å‡º: 31392b333d3f_22_abc123.png
# âœ“ æ— ç‰¹æ®Šå­—ç¬¦ï¼Œæ–‡ä»¶æˆåŠŸåˆ›å»º
```

---

## ä½¿ç”¨è¯´æ˜

### ç”Ÿæˆæ–°æ ¼å¼éªŒè¯ç 

```bash
cd captcha
python generate_captcha.py --count 30000
```

æ‰€æœ‰æ•°å­¦é¢˜å°†ä½¿ç”¨16è¿›åˆ¶ç¼–ç æ ¼å¼ï¼Œä¸ä¼šå†å‡ºç°æ–‡ä»¶è·¯å¾„é”™è¯¯ã€‚

### è®­ç»ƒæ¨¡å‹

æ— éœ€ä»»ä½•æ”¹åŠ¨ï¼Œè®­ç»ƒè„šæœ¬ä¼šè‡ªåŠ¨è¯†åˆ«æ–°æ—§æ ¼å¼ï¼š

```bash
cd caocrvfy
python train_v4.py
```

---

## æ€»ç»“

| å¯¹æ¯”é¡¹ | Base64 | 16è¿›åˆ¶ |
|--------|--------|--------|
| å­—ç¬¦é›† | A-Za-z0-9+/= | 0-9a-f |
| ç‰¹æ®Šå­—ç¬¦ | âœ— åŒ…å« `/` `=` | âœ“ æ— ç‰¹æ®Šå­—ç¬¦ |
| æ–‡ä»¶è·¯å¾„é—®é¢˜ | âœ— å¯èƒ½è¯¯è§£æ | âœ“ å®Œå…¨é¿å… |
| ç¼–ç é•¿åº¦ | è¾ƒçŸ­ | è¾ƒé•¿ |
| æ˜“è¯»æ€§ | ä¸€èˆ¬ | è¾ƒå¥½ |
| ç¼–è§£ç å¤æ‚åº¦ | éœ€è¦å¡«å…… | æ— éœ€å¡«å…… |
| **æ¨èåº¦** | ä¸æ¨è | âœ… **æ¨è** |

**ç»“è®º**: 16è¿›åˆ¶ç¼–ç æ›´é€‚åˆæ–‡ä»¶ååœºæ™¯ï¼Œå½»åº•è§£å†³äº†base64çš„ç‰¹æ®Šå­—ç¬¦é—®é¢˜ã€‚

---

**ç›¸å…³æ–‡æ¡£**:
- [æ•°å­¦é¢˜ä¸‰æ­¥éªŒè¯æµç¨‹](MATH_THREE_STEP_VALIDATION_2026-02-01.md)
- [è®­ç»ƒæ ‡ç­¾éªŒè¯æŠ¥å‘Š](TRAINING_LABEL_VERIFICATION_2026-02-01.md)
